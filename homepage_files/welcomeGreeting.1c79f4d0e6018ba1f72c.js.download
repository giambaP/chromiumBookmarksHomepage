(window.webpackJsonp=window.webpackJsonp||[]).push([["welcomeGreeting"],{"7oW3":function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a("G82u");class i{}i.updateLocationDisplayName=new n.a("UpdateLocationDisplayName"),i.fetchWeatherSummarySuccess=new n.a("FetchWeatherSummarySuccess"),i.updateLocationDetectionState=new n.a("UpdateLocationDetectionState")},B9k1:function(e,t){},JbJS:function(e,t){},Rlhs:function(e,t,a){"use strict";a.r(t);var n=a("JbJS"),i=a("ERkP"),r=a("wirn"),o=a("5mwN"),s=a("qGiF");const c={WrapperTelemetry:"welcome",WeatherTelemetry:"weather_today"},h={welcomeContainerId:"i_welcome",weatherContainerId:"i_weather"};var d=a("YJhp");const l={23:d.a.RainShowersDay,26:d.a.SnowShowersDay,6:d.a.BlowingHail,5:d.a.Cloudy,20:d.a.LightSnow,91:d.a.Windy,27:d.a.Thunderstorms,10:d.a.FreezingRain,77:d.a.RainShowersDay,12:d.a.HazeSmoke,24:d.a.RainSnow,78:d.a.RainSnowShowersNight,9:d.a.Fog,3:d.a.PartlyCloudyDay,43:d.a.HailNight,16:d.a.HailDay,8:d.a.LightRain,15:d.a.HeavySnow,28:d.a.ClearNight,30:d.a.PartlyCloudyNight,14:d.a.ModerateRain,1:d.a.SunnyDay,7:d.a.BlowingSnow,50:d.a.RainShowersNight,82:d.a.SnowShowersNight},g={23:d.a.RainShowersDayWhite,26:d.a.SnowShowersDayWhite,6:d.a.BlowingHailWhite,5:d.a.CloudyWhite,20:d.a.LightSnowWhite,91:d.a.WindyWhite,27:d.a.ThunderstormsWhite,10:d.a.FreezingRainWhite,77:d.a.RainShowersDayWhite,12:d.a.HazeSmokeWhite,24:d.a.RainSnowWhite,78:d.a.RainSnowShowersNightWhite,9:d.a.FogWhite,3:d.a.PartlyCloudyDayWhite,43:d.a.HailNightWhite,16:d.a.HailDayWhite,8:d.a.LightRainWhite,15:d.a.HeavySnowWhite,28:d.a.ClearNightWhite,30:d.a.PartlyCloudyNightWhite,14:d.a.ModerateRainWhite,1:d.a.SunnyDayWhite,7:d.a.BlowingSnowWhite,50:d.a.RainShowersNightWhite,82:d.a.SnowShowersNightWhite},u={17:"8",31:"30",49:"14",41:"14",35:"8",4:"3",19:"8",22:"14",23:"23",40:"8",25:"15",34:"7",47:"20",52:"15",53:"26",57:"7",58:"7",59:"7",60:"7",81:"26",11:"10",37:"10",38:"10",51:"24",65:"16",66:"43",69:"10",70:"10",71:"10",72:"10",73:"16",74:"43",89:"12",92:"91",32:"5",2:"1",101:"1",42:"15",33:"6",61:"6",62:"6",87:"6",88:"6",93:"6",94:"6",95:"6",96:"6",54:"27",67:"27",68:"27",90:"12",18:"9",21:"9",36:"9",45:"9",48:"9",63:"9",64:"9",29:"28",102:"28",44:"8",46:"8",79:"23",80:"50",76:"24",75:"24",83:"77",84:"78",85:"24",86:"24",39:"12",13:"8"};var m=a("6u3Q");class p extends o.a{constructor(e,...t){super(e,...t,!0),this.handledProps={canDisplayGreetingModule:void 0,customField:void 0,experienceName:void 0,greetingFadeIn:void 0,isImageEnabled:void 0,managedClasses:void 0,onExperienceMilestoneTimingUpdate:void 0,shouldAnimationStart:void 0,weatherLink:void 0,weatherGlyph:void 0,weatherText:void 0,welcomeText:void 0}}componentDidUpdate(e){if(this.props.canDisplayGreetingModule&&this.props.shouldAnimationStart!==e.shouldAnimationStart){const e=document.getElementById(h.welcomeContainerId),t=document.getElementById(h.weatherContainerId);this.props.greetingFadeIn(e,t,0,700)}}render(){if(this.props.canDisplayGreetingModule){super.render();const{isImageEnabled:e,managedClasses:t,weatherLink:a,weatherText:n,weatherGlyph:o,welcomeText:c}=this.props,d=e?t.textWrapper_ImageDisplayed:t.textWrapper_ImageHidden;return i.createElement("div",Object.assign({className:super.generateClassNames(t.root)},this.unhandledProps()),i.createElement("a",{href:a,className:t.wrapper,id:h.weatherContainerId},i.createElement(s.a,null,a=>o&&o.imageSkyCode&&o.ariaLabel&&i.createElement("div",{className:t.image},i.createElement(r.a,{ariaLabel:o.ariaLabel,glyphType:this.getImage(a,e,o.imageSkyCode)}))),i.createElement("div",{className:d},n&&i.createElement("span",{className:t.weather},n))),i.createElement("div",{className:d},c&&i.createElement("span",{id:h.welcomeContainerId,className:t.welcome},c)))}return null}getImage(e,t,a){return function(e,t){let a=u.hasOwnProperty(e)?u[e]:e;return(t?g:l)[a]}(a,Object(m.e)(e)||t)}}p.defaultProps={experienceName:"WelcomeGreeting"};var y=a("G82u");class w{}w.updateIsImageEnabled=new y.a("UpdateIsImageEnabled"),w.updateWeatherImage=new y.a("UpdateWeatherImage"),w.updateWeatherLink=new y.a("UpdateWeatherLink"),w.updateWeatherText=new y.a("UpdateWeatherText"),w.shouldAnimationStart=new y.a("ShouldAnimationStart"),w.disableGreetingModule=new y.a("DisableGreetingFeature");var S=a("ubYE"),f=a("D57K"),W=a("HHhA"),b=a("mL67"),C=a("jE1l"),D=a("9J8d"),I=a("NiiX"),A=a("zMW0"),x=a("7oW3"),v=a("pLgf"),G=a("WfnD"),O=a("s9+9"),T=a("I6Lx"),E=a("eoyk"),N=a("kpPY");function k(e,t){const{localizedStrings:a}=e,n=e.isNameInGreeting?function(e,t){const{localizedStrings:a}=e;if(t){const n=t.firstName,i=t.lastName;return e.showFirstNameOnly?n:e.showLastNameOnly?i:Object(N.a)(a.nameOrderingFull,n,i)}return""}(e,t):"";let i=a.welcomeText;return function(e){let t=0;for(let a of e.greetingsList){if(t>a.startHour||a.endHour<a.startHour)return!1;t=a.endHour}return!0}(e)&&(i=function(e,t){const{localizedStrings:a}=e;for(let n of e.greetingsList)if(t>=n.startHour&&t<n.endHour)return a[n.displayKey];return a.welcomeText}(e,(new Date).getHours())),n&&n.length<=e.maxNameCharacterCount&&a.greetingFormat&&(i=Object(N.a)(a.greetingFormat,i,n)),i}const L={inspect:e=>{let{config:t,state:a,connectorArgs:n}=e;return{props:{greetingFadeIn:n.startGreetingAnimation,isImageEnabled:a.isImageEnabled,shouldAnimationStart:a.shouldAnimationStart,welcomeText:k(t,n.accountSettings),weatherLink:a.weatherLink,weatherText:a.weatherText,weatherGlyph:a.weatherGlyph,canDisplayGreetingModule:n.canDisplayGreetingModule},missingChildren:[]}}};class j extends G.a{constructor(e,t,a,n,i,r){super(e,t,a,n,i,r),this.animationDelayDefault=2e3,this.updateWeatherDataState=()=>{const e=this.weatherDataConnector.getCurrentState();this.sendWeatherUpdateActions(e)},this.pageSettingsDataConnector=a.connector(O.a.ChromiumPageSettings),this.pageSettingsDataConnector||(this.pageSettingsDataConnector=new W.a(O.a.ChromiumPageSettings,"",a,new b.a,i))}updateWeatherIconFromStateChange(e){const t=e&&e.params;!t||t.length<1||(this.bingImageEnabled=t[0].imageOfTheDayEnabled,w.updateIsImageEnabled.getActionSender(this).send(this.bingImageEnabled))}startAnimationWithDelay(e){setTimeout(()=>{w.shouldAnimationStart.getActionSender(this).send(!0)},e)}sendWeatherUpdateActions(e){if(!e.currentCondition)return;const t=e.currentCondition.currentTemperature+"Â°";w.updateWeatherText.getActionSender(this).send(t);const a=e.currentCondition.image&&e.currentCondition.image.alt;this.currentWeatherIconId=e.currentCondition.pvdrIcon,w.updateWeatherImage.getActionSender(this).send(Object.assign({imageSkyCode:this.currentWeatherIconId,ariaLabel:a},I.a.render(I.a.getChildTelemetryItem(this.telemetryProps,c.WeatherTelemetry,A.b.StructuredData)))),w.updateWeatherLink.getActionSender(this).send(e.currentCondition.deepLink)}mapStateToProps(e){let t={config:this.config,state:e,connectorArgs:{startGreetingAnimation:F,canDisplayGreetingModule:this.canDisplayGreetingModule,accountSettings:this.primaryAccountSettings}},a=L.inspect(t);return Object.assign(Object.assign({},a.props),this.telemetryTags)}onComponentConnect(e){return Object(f.a)(this,void 0,void 0,function*(){"true"!==T.b.ClientSettings.static_page&&(yield this.pageSettingsDataConnector.getConfigDataAsync()).isNewTabGreetingEnabled&&(this.primaryAccountSettings=yield this.pageSettingsDataConnector.getPrimaryAccountInfoAsync(),this.canDisplayGreetingModule=this.primaryAccountSettings.accountType===C.c.MSA),this.canDisplayGreetingModule||w.disableGreetingModule.getActionSender(this).send(!0),G.a.prototype.onComponentConnect.call(this,e),D.a.getInstance().rootReducer.getDataConnector(O.a.WeatherData).then(e=>Object(f.a)(this,void 0,void 0,function*(){e&&(this.weatherDataConnector=e,this.setupWeatherDataObservers(),this.weatherDataConnector.fetchActiveStateforWeather().then(e=>Object(f.a)(this,void 0,void 0,function*(){if(this.config.hasWhiteIconTransitions&&(this.bingImageEnabled=(yield this.pageSettingsDataConnector.getPageSettingsStateAsync()).imageOfTheDayEnabled,w.updateIsImageEnabled.getActionSender(this).send(this.bingImageEnabled),E.a.updateLayout.registerObserver(e=>{this.updateWeatherIconFromStateChange(e)})),e){const e=this.weatherDataConnector.getCurrentState();this.sendWeatherUpdateActions(e),this.startAnimationWithDelay(this.config.animationDelay||this.animationDelayDefault)}})))}))})}setupWeatherDataObservers(){x.a.fetchWeatherSummarySuccess.registerObserver(this.updateWeatherDataState)}}function F(e,t,a,n){const i=new v.AnimateTo(e,{opacity:0},{duration:n,delay:a}),r=new v.AnimateTo(t,{opacity:1},{duration:n,delay:0});i.onFinish=()=>{window.requestAnimationFrame(()=>{e.style.display="none",t.style.display="flex",i.cancel(),r.play()})},i.play()}var H=a("05Au");class R{reduce(e,t){if(!e)return{};let a,n=!1;return t?(n=(n=(n=(n=(n=(n=H.a.handleAction(t,w.updateWeatherText,t=>{a=Object.assign(Object.assign({},e),{weatherText:t})}))||H.a.handleAction(t,w.updateWeatherImage,t=>{a=Object.assign(Object.assign({},e),{weatherGlyph:t})}))||H.a.handleAction(t,w.shouldAnimationStart,t=>{a=Object.assign(Object.assign({},e),{shouldAnimationStart:t})}))||H.a.handleAction(t,w.updateWeatherLink,t=>{a=Object.assign(Object.assign({},e),{weatherLink:t})}))||H.a.handleAction(t,w.updateIsImageEnabled,t=>{a=Object.assign(Object.assign({},e),{isImageEnabled:t})}))||H.a.handleAction(t,w.disableGreetingModule,t=>{a=Object.assign(Object.assign({},e),{canDisplayGreetingModule:!t})}),a||e):e}}const M={root:{display:"flex","font-size":"14px",height:"50px",width:"120px"},image:{float:"left",height:"24px","margin-bottom":"auto","margin-top":"auto",width:"24px"},wrapper:{color:"inherit",display:"none",opacity:"0","text-decoration":"none",width:"100px"},weather:{"font-size":"24px","margin-bottom":"auto","margin-top":"auto","padding-bottom":"3px","padding-left":"10px","padding-right":"10px"},textWrapper_ImageHidden:{display:"flex",color:a("SP+O").c},textWrapper_ImageDisplayed:{display:"flex",color:"#FFFFFF"},welcome:{"font-size":"14px","line-height":"20px","margin-bottom":"auto","margin-top":"auto",opacity:"1","white-space":"pre-wrap",width:"120px"}};var P=a("+viU"),z=a("B9k1"),U=a("ZG2z");a.d(t,"ToolingInfo",function(){return J}),a.d(t,"WelcomeGreeting",function(){return B}),a.d(t,"WelcomeGreetingActions",function(){return w}),a.d(t,"WelcomeGreetingReducer",function(){return R}),a.d(t,"WelcomeGreetingConnector",function(){return j});const B=Object(P.a)(M)(p),J={reactComponent:B,experienceConfigSchema:S.WelcomeGreetingConfigSchema,defaultMockState:n.mockDefaultState,mockState:n.mockState,mockConfig:z.mockConfig,mockConnectorArgs:U.mockConnectorArgs,inspector:L.inspect}},ZG2z:function(e,t){},kpPY:function(e,t,a){"use strict";a.d(t,"a",function(){return n}),a.d(t,"c",function(){return i}),a.d(t,"b",function(){return r});a("nwjK");function n(e,...t){return e.replace(/{(\d+)}/g,function(e,a){if(a>=t.length)return e;const n=t[a];return"number"==typeof n||n?n:""})}function i(e,t,a=0){return!(!e||!t)&&e.substr(a,t.length)===t}function r(e){return!e||!e.trim()}},ubYE:function(e,t){}}]);
//# sourceMappingURL=welcomeGreeting.1c79f4d0e6018ba1f72c.js.map
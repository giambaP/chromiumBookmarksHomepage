(window.webpackJsonp=window.webpackJsonp||[]).push([["weather-data-connector"],{"/FrS":function(e,t,i){"use strict";i.d(t,"c",function(){return a}),i.d(t,"a",function(){return o}),i.d(t,"d",function(){return n}),i.d(t,"b",function(){return r});class a{}var o,n;!function(e){e[e.DetectCurrentLocation=1]="DetectCurrentLocation",e[e.SpecifyLocation=2]="SpecifyLocation"}(o||(o={})),function(e){e[e.Fahrenheit=1]="Fahrenheit",e[e.Celsius=2]="Celsius"}(n||(n={}));const r={WeatherSpartanHomeLocationCookie:"weaSpartanHomeLocation",WeatherHomeLocationCookie:"weaPeregrineHomeLocation",WeatherSpartanDegreeSettingCookie:"weaSpartanDegreeType",WeatherDegreeSettingCookie:"weaPeregrineDegreeType",WeatherSpartanDetectLocationSetting:"weaDetectLocation",WeatherDetectLocationSetting:"weaPeregrineDetectLocation",EnglishLocationMarkets:"en-",cookieExpirationTimeInDays:365,cookieDomain:"msn.com"}},"6ADy":function(e,t,i){"use strict";i.d(t,"c",function(){return d}),i.d(t,"a",function(){return u}),i.d(t,"d",function(){return l}),i.d(t,"b",function(){return h});var a=i("rvYQ"),o=i("I6Lx"),n=i("kN1G"),r=i("tMmC");let c,s;function d(){const e=Object(a.b)();if(!c){!function(e){g(c=new URL("",e))}(Object(n.g)()&&Object(n.h)()?e.EnterpriseServiceUrlBase:e.ServiceUrlBase)}return c}function u(){const e=Object(a.b)();if(!s){!function(e){g(s=new URL("",e))}(Object(n.g)()&&Object(n.h)()?e.EnterpriseServiceUrlBase:e.FeedServiceUrlBase)}return s}function l(e){return new URL(e+d().search,d())}function h(e){return new URL(e+u().search,u())}function g(e){let t=!1;"dev"!==e.searchParams.get("env.service")&&Object(o.a)().UserIsSignedIn&&(t=!0),r.a.log("u-si: "+Object(a.b)().UserId),r.a.log("a-si: "+t),r.a.log("ss-si: "+Object(o.a)().UserIsSignedIn)}},"7oW3":function(e,t,i){"use strict";i.d(t,"a",function(){return o});var a=i("G82u");class o{}o.updateLocationDisplayName=new a.a("UpdateLocationDisplayName"),o.fetchWeatherSummarySuccess=new a.a("FetchWeatherSummarySuccess"),o.updateLocationDetectionState=new a.a("UpdateLocationDetectionState")},I855:function(e,t,i){"use strict";i.r(t);var a=i("/FrS"),o=i("7oW3"),n=i("cYI1"),r=i("D57K"),c=i("1w6q"),s=i("tERu"),d=i("4wjP"),u=i("I6Lx"),l=i("zfSW"),h=i("rvYQ"),g=i("hOj1"),m=i("3Amp"),p=i("msIb"),y=i("KETb"),b=i("HxRh"),f=i("/+Un"),S=i("CA7x");class v{constructor(e){this.fetchImpl=e,this.ocid="Peregrine",this.localizeLocationApi="weather/locations/search/"}getLocalisedLocationDetails(e){return Object(r.a)(this,void 0,void 0,function*(){if(!e||!e.latitude||!e.longitude)return e;const t=yield p.a.getBaseRequestData("GET");let i=[...(yield Object(f.b)())===s.c.SignedIn?p.a.getOneServiceParamsWithAuth(h.a.UserId,this.ocid):p.a.getOneServiceParamsWithoutAuth(h.a.UserId,this.ocid),{key:"lat",value:e.latitude},{key:"lon",value:e.longitude},{key:"locale",value:h.a.CurrentMarket}];const a=new URL(`${this.localizeLocationApi}${h.a.ServiceUrlBase.search}`,h.a.ServiceUrlBase);i.forEach(e=>{e.value&&a.searchParams.set(e.key,e.value)});try{const i=yield Object(y.a)(()=>Object(r.a)(this,void 0,void 0,function*(){let e=yield this.fetchImpl(a.href,t);if(!e.ok)throw Error(e.statusText);return e.json()}),"getLocalizedLocation"),o=i&&i.value&&i.value[0]&&i.value[0].responses||[];o[0]&&o[0].locations[0]&&o[0].locations[0].displayName&&(e.displayName=o[0].locations[0].displayName)}catch(e){S.a.trackAppErrorEvent(Object.assign(Object.assign({},b.qb.WeatherLocalizeLocationFailed),{message:`Error whilefetching localise Locationl: ${a.href}, error: ${e}`}))}return e})}}var L,A=i("hSGL");!function(e){e[e.Size30=1]="Size30",e[e.Size50=2]="Size50"}(L||(L={}));const O={23:"AAekRsY.img",26:"AAekP1G.img",6:"AAekzfx.img",5:"AAekHbj.img",20:"AAeku2v.img",91:"AAekP1I.img",27:"AAekZha.img",10:"AAekwJU.img",77:"AAekHbm.img",12:"AAekU2D.img",24:"AAekJUc.img",78:"AAeku2w.img",9:"AAekrqP.img",3:"AAekwJT.img",43:"AAekzfy.img",16:"BBaRgH.img",8:"AAekBPS.img",15:"AAeku2u.img",28:"AAekU2E.img",30:"AAekErI.img",14:"AAekErH.img",1:"AAekoR7.img",7:"AAekmhd.img",50:"AAekRsZ.img",82:"AAekmhg.img"},D={23:"AAehOqC.img",26:"AAehE44.img",6:"AAehOqA.img",5:"AAehyQC.img",20:"AAehE45.img",91:"AAehWcc.img",27:"AAehOqE.img",10:"AAehGG5.img",77:"AAehWca.img",12:"AAehYNC.img",24:"AAehGG6.img",78:"AAei6xK.img",9:"AAei3XW.img",3:"AAehLNN.img",43:"AAei6xL.img",16:"BBaRgH.img",8:"AAehyQD.img",15:"AAei6xJ.img",28:"AAehwh2.img",30:"AAehOqD.img",14:"AAehOqB.img",1:"AAehR3S.img",7:"AAehYNB.img",50:"AAehYND.img",82:"AAehWcb.img"},k={17:"8",31:"30",49:"14",41:"14",35:"8",4:"3",19:"8",22:"14",23:"23",40:"8",25:"15",34:"7",47:"20",52:"15",53:"26",57:"7",58:"7",59:"7",60:"7",81:"26",11:"10",37:"10",38:"10",51:"24",65:"16",66:"43",69:"10",70:"10",71:"10",72:"10",73:"16",74:"43",89:"12",92:"91",32:"5",2:"1",101:"1",42:"15",33:"6",61:"6",62:"6",87:"6",88:"6",93:"6",94:"6",95:"6",96:"6",54:"27",67:"27",68:"27",90:"12",18:"9",21:"9",36:"9",45:"9",48:"9",63:"9",64:"9",29:"28",102:"28",44:"8",46:"8",79:"23",80:"50",76:"24",75:"24",83:"77",84:"78",85:"24",86:"24",39:"12",13:"8"};class j{static getSkyCodeUrl(e,t){var i=k.hasOwnProperty(e)?k[e]:e;const a="//img-s-msn-com.akamaized.net/tenant/amp/entityid/";switch(t){case L.Size30:return a+O[i];case L.Size50:return a+D[i];default:return null}}}var C=i("ax+D"),U=i("r6MD");class W{static isValidWeatherSummaryResponse(e){const t=!!e&&C.a.arrayHasData(e.responses)&&e.responses.length&&!!e.responses[0].weather?e.responses[0].weather:null;return C.a.arrayHasData(t)&&C.a.arrayHasData(t[0].forecast.days)}TranslateToWeatherForecast(e,t){if(!e||!W.isValidWeatherSummaryResponse(e))throw new Error("Weather Service response schema validation error: no summary found!");const i=t.latitude||Object(U.a)(e,"responses[0].source.coordinates.lat",""),a=t.longitude||Object(U.a)(e,"responses[0].source.coordinates.lon",""),o=e.responses[0].weather[0],n={isAlert:o.alerts>0,currentTemperature:o.current.temp&&o.current.temp.toString(),pvdrIcon:o.current&&o.current.pvdrIcon,image:{src:j.getSkyCodeUrl(o.current&&o.current.pvdrIcon,L.Size50),alt:o.current&&o.current.cap},skycode:{children:o.current&&o.current.cap},precipitation:{children:o.forecast&&o.forecast.days&&o.forecast.days[0]&&null!=o.forecast.days[0].precip?`${o.forecast.days[0].precip}%`:void 0},deepLink:`https://a.msn.com/54/${Object(u.a)().Locale}/ct${i},${a}`,degreeSetting:e.units.temperature.replace(/\u200e/g,""),alternateDegreeSetting:e.units.temperature.replace(/\u200e/g,"").includes("C")?"째F":"째C"},r=o.forecast.days.map((e,t)=>{const o=e&&e.valid&&e.valid.split("T")[0].split("-"),n=new Date(Number(o[0]),Number(o[1])-1,Number(o[2]));return{id:Math.random().toString(24).substring(2),day:n,highTemperature:`${e.tempHi}째`,lowTemperature:`${e.tempLo}째`,image:{src:j.getSkyCodeUrl(e.icon&&e.icon.toString()||e.pvdrIcon,L.Size30),alt:e.cap},deepLink:`https://a.msn.com/54/${Object(u.a)().Locale}/ct${i},${a}?day=${t+1}`}});return{lastUpdated:o.current&&o.current.created,currentCondition:n,forecast:r}}}class I{constructor(e,t){this.fetchImpl=e,this.weatherSummaryApi="view/v1/weathersummary/",this.schemaTranslator=new W}getWeatherSumary(e,t){return Object(r.a)(this,void 0,void 0,function*(){const i={method:"GET",headers:{}},o=[{key:"units",value:t===a.d.Fahrenheit?"F":"C"},{key:"days",value:"5"}];if(!e||!e.latitude||!e.longitude||""===e.latitude||""===e.longitude)return null;const n=new URL(this.weatherSummaryApi+h.a.CurrentMarket+"/"+e.latitude+","+e.longitude+h.a.ContentServiceUrlBase.search,h.a.ContentServiceUrlBase);o.forEach(e=>{e.value&&n.searchParams.set(e.key,e.value)});const c=yield Object(y.a)(()=>Object(r.a)(this,void 0,void 0,function*(){const e=yield this.fetchImpl(n.href,i);if(!e.ok)throw Error(e.statusText);return e.json()}),"getWeatherSummary");return this.schemaTranslator.TranslateToWeatherForecast(c,e)})}}var P=i("l+Jz"),E=i("tWvP");class T extends c.a{constructor(e,t,i,a,o,n){super(e,t,i,a,o,n),this.PdpDefaultLocation="DefaultLocation",this.PdpFavoriteLocation="FavoriteLocation";const r=window.fetch.bind(window);this.serviceClient=new I(r,this.config),this.pdpserviceClient=new A.a(r),this.localizeLocationService=new v(r),this.signInStatus=s.c.Unknown}fetchActiveStateforWeather(e){return Object(r.a)(this,void 0,void 0,function*(){if(this.getWeatherLocation&&!e)return this.getWeatherLocation;this.getWeatherCookies();let t=this.getCurrentState().currentLocation,i=this.config.setDefaultUnitToCelsius?a.d.Celsius:a.d.Fahrenheit;return this.getWeatherLocation=new Promise(e=>Object(r.a)(this,void 0,void 0,function*(){try{if(t=this.getHomeLocationfromCookies()||this.getGeoLocation()||t,i=this.getDisplayUnitFromCookie()||i,this.isDetectLocationSetInCookie()&&(t=this.getGeoLocation(),o.a.updateLocationDetectionState.getActionSender(this).send(a.a.DetectCurrentLocation,t)),yield this.updateSignedInStatus(),this.isUserLoggedIn()){const e=yield this.readFromPdp();e&&(!this.isDetectLocationSetInCookie()&&e.myLocation&&(t=e.myLocation),e.unit&&(i=e.unit))}}catch(e){S.a.trackAppErrorEvent(Object.assign(Object.assign({},b.qb.WeatherLocationEmpty),{message:`Weather Location fetch failed from Weather Data Connector with error = ${e.toString()}`}))}e(t),t||S.a.trackAppErrorEvent(Object.assign(Object.assign({},b.qb.WeatherLocationEmpty),{message:`Weather Location fetch failed from Weather Data Connector with empty activeLocation, Geo Latitude = ${u.b.ClientSettings&&u.b.ClientSettings.geo_lat},\n                        & Geo Longitude =  ${u.b.ClientSettings&&u.b.ClientSettings.geo_long}`})),t&&(this.getWeatherForecastData(t,i),this.updateLocationDisplayName(t))})),this.getWeatherLocation})}updateSettingsAndFetch(e,t,i){return Object(r.a)(this,void 0,void 0,function*(){let n=e===a.a.SpecifyLocation&&null!==t&&""!==t.latitude&&""!==t.longitude;n=n&&!(t.latitude===this.getCurrentState().currentLocation.latitude&&t.longitude===this.getCurrentState().currentLocation.longitude);const r=i!==this.getCurrentState().unit;return t&&""!==t.latitude&&""!==t.latitude||(t=this.getCurrentState().currentLocation),e===a.a.DetectCurrentLocation?(t=this.getGeoLocation(),this.setDetectCurrentLocationCookies(),o.a.updateLocationDetectionState.getActionSender(this).send(a.a.DetectCurrentLocation,t)):this.RemoveDetectLocationCookies(),this.getWeatherForecastData(t,i),this.updateLocationDisplayName(t),this.isUserLoggedIn()&&n&&this.savetoPDPLocation(t),this.isUserLoggedIn()||e!==a.a.SpecifyLocation||this.setHomeLocationInCookies(t),r&&(this.isUserLoggedIn()?this.savetoPDPDisplayUnit(i):this.setDisplayUnitCookie(i)),Object(l.c)({id:P.a.InvalidateWeatherPdp,type:"command"}),t})}updateSignedInStatus(){return Object(r.a)(this,void 0,void 0,function*(){this.signInStatus===s.c.Unknown&&(this.signInStatus=yield Object(f.b)(),m.a.signedInStatus.registerObserver(e=>Object(r.a)(this,void 0,void 0,function*(){this.isUserLoggedIn()||(this.signInStatus=yield Object(f.b)(),this.isUserLoggedIn()&&this.fetchActiveStateforWeather(!0))})))})}isUserLoggedIn(){return this.signInStatus===s.c.SignedIn}readFromPdp(){return Object(r.a)(this,void 0,void 0,function*(){try{const e=yield this.pdpserviceClient.readPdpWithTargetType("Location"),{value:t=[]}=e||{};return!t||t.length<1?null:this.convertPdpDataToPdpResponse(t)}catch(e){return S.a.trackAppErrorEvent(Object.assign(Object.assign({},b.qb.WeatherPDPReadFailed),{message:`Weather PDP Read Failed with error : ${e.toString()}`})),null}})}savetoPDPLocation(e){return Object(r.a)(this,void 0,void 0,function*(){let t=!1;try{const i=`${e.latitude},${e.longitude}`,a=e.locality,o=e.region,n=e.country,r=e.postalCode,c=e.locationTypeId,s=e.isoCode,d=e.locationType,u=JSON.parse(JSON.stringify({city:a,state:o,countryRegion:n,postalCode:r,locationTypeId:c,isoCode:s,locationType:d}));t=yield this.pdpserviceClient.updatePdpHomeLocation(u,i)}catch(e){S.a.trackAppErrorEvent(Object.assign(Object.assign({},b.qb.WeatherPDPHomeLocationWriteFailed),{message:"Home Location Update Failed"})),t=!1}return t})}savetoPDPDisplayUnit(e){return Object(r.a)(this,void 0,void 0,function*(){let t=!1;try{t=yield this.pdpserviceClient.updatePdpDisplayUnit(e.toString())}catch(e){S.a.trackAppErrorEvent(Object.assign(Object.assign({},b.qb.WeatherPDPDisplayUnitWriteFailed),{message:"DisplayUnit Update failed"})),t=!1}return t})}updateLocationDisplayName(e){return Object(r.a)(this,void 0,void 0,function*(){if(h.a.CurrentMarket.includes(a.b.EnglishLocationMarkets)&&e)return void o.a.updateLocationDisplayName.getActionSender(this).send(e);if(!e||!e.latitude||!e.longitude)return void S.a.trackAppErrorEvent(Object.assign(Object.assign({},b.qb.WeatherLocationEmpty),{message:"No valid User location set "}));let t=e;(t=yield this.localizeLocationService.getLocalisedLocationDetails(e))&&t.displayName||S.a.trackAppErrorEvent(Object.assign(Object.assign({},b.qb.WeatherLocalizeLocationFailed),{message:`Failed to get localised location data for ${e.latitude} & ${e.longitude}`})),o.a.updateLocationDisplayName.getActionSender(this).send(t)})}getWeatherForecastData(e,t){return Object(r.a)(this,void 0,void 0,function*(){return e&&e.latitude&&e.longitude?!!(yield this.fetchWeatherSummary(e,t))||(S.a.trackAppErrorEvent(Object.assign(Object.assign({},b.qb.WeatherSummaryFetchError),{message:`Failed to get summary data for ${e.latitude} & ${e.longitude}`})),!1):(S.a.trackAppErrorEvent(Object.assign(Object.assign({},b.qb.WeatherLocationEmpty),{message:"No valid User location set "})),!1)})}fetchWeatherSummary(e,t){return Object(r.a)(this,void 0,void 0,function*(){try{const i=yield this.serviceClient.getWeatherSumary(e,t);return o.a.fetchWeatherSummarySuccess.getActionSender(this).send(i,e,t),!0}catch(e){return S.a.trackAppErrorEvent(Object.assign(Object.assign({},b.qb.WeatherSummaryFetchError),{message:`Exception in Summary call :Error: ${e}`})),!1}})}getGeoLocation(){return u.b.ClientSettings&&u.b.ClientSettings.geo_lat&&u.b.ClientSettings.geo_long&&""!==u.b.ClientSettings.geo_lat&&""!==u.b.ClientSettings.geo_long?{latitude:u.b.ClientSettings.geo_lat,longitude:u.b.ClientSettings.geo_long,locality:u.b.ClientSettings.geo_city,region:u.b.ClientSettings.geo_subdivision,country:u.b.ClientSettings.geo_countryname}:null}getWeatherCookies(){switch(h.a.CurrentRequestTargetScope&&h.a.CurrentRequestTargetScope.pageType){case d.b.DHP:case d.b.NTP:this.cookieToUseForHomeLocation=a.b.WeatherSpartanHomeLocationCookie,this.cookieToUseForDegreeType=a.b.WeatherSpartanDegreeSettingCookie,this.cookieToUseForDetectLocation=a.b.WeatherSpartanDetectLocationSetting;break;default:this.cookieToUseForHomeLocation=a.b.WeatherHomeLocationCookie,this.cookieToUseForDegreeType=a.b.WeatherDegreeSettingCookie,this.cookieToUseForDetectLocation=a.b.WeatherDetectLocationSetting}}getHomeLocationfromCookies(){const e=Object(g.a)(this.cookieToUseForHomeLocation);if(e&&e.length>0){const t=e.split("|");if(t.length>3&&t[2]&&t[3])return{longitude:decodeURIComponent(t[3]),latitude:decodeURIComponent(t[2]),locality:t[4]&&decodeURIComponent(t[4]),region:t[5]&&decodeURIComponent(t[5]),country:t[6]&&decodeURIComponent(t[6])}}return null}isDetectLocationSetInCookie(){const e=Object(g.a)(this.cookieToUseForDetectLocation);return e&&e.length>0&&"1"===e}getDisplayUnitFromCookie(){const e=Object(g.a)(this.cookieToUseForDegreeType);return e&&e.length>0?"F"===e?a.d.Fahrenheit:a.d.Celsius:null}setDisplayUnitCookie(e){const t=e===a.d.Celsius?"C":"F";Object(E.a)(this.cookieToUseForDegreeType,t,a.b.cookieExpirationTimeInDays,a.b.cookieDomain,"/")}setHomeLocationInCookies(e){const t=`||${e.latitude}|${e.longitude}|${encodeURI(e.locality)}|${encodeURI(e.region)}|${encodeURI(e.country)}|${encodeURI(e.isoCode)}|0|1|||`;Object(E.a)(this.cookieToUseForHomeLocation,t,a.b.cookieExpirationTimeInDays,a.b.cookieDomain,"/")}setDetectCurrentLocationCookies(){Object(E.a)(this.cookieToUseForDetectLocation,"1",a.b.cookieExpirationTimeInDays,a.b.cookieDomain,"/")}RemoveDetectLocationCookies(){Object(E.a)(this.cookieToUseForDetectLocation,"0",-1,a.b.cookieDomain,"/")}convertPdpDataToPdpResponse(e){if(e&&e[0]){const t=e.filter(e=>e.degree===this.PdpDefaultLocation),i=t&&t.length>0?t.sort((e,t)=>new Date(t.updatedDateTime).valueOf()-new Date(e.updatedDateTime).valueOf())[0]:null;if(!i||!i.definitionName)return null;const o=i&&i.definitionName&&i.definitionName.split(",");let n=null;if(o&&o.length>1&&(n={latitude:o[0],longitude:o[1],locality:i.metadata&&i.metadata.city,region:i.metadata&&i.metadata.state,country:i.metadata&&i.metadata.countryRegion,displayName:"",isoCode:i.metadata&&i.metadata.isoCode}),"0"===n.latitude&&"0"===n.longitude)return null;return{myLocation:n,unit:i.metadata&&"2"===i.metadata.displayunit?a.d.Celsius:a.d.Fahrenheit,favLocations:e.filter(e=>e.degree===this.PdpFavoriteLocation)}}return null}}var w=i("05Au");class F{constructor(){this.INITIAL_STATE={locationDetectionSetting:a.a.SpecifyLocation,unit:a.d.Fahrenheit}}reduce(e,t){if(!e)return this.INITIAL_STATE;if(!t)return e;let i=!1,a=null;return i=(i=(i=i||w.a.handleAction(t,o.a.fetchWeatherSummarySuccess,(t,i,o)=>{(a=Object.assign({},e)).currentCondition=t.currentCondition,a.forecast=t.forecast,a.lastUpdated=t.lastUpdated,null!==i&&i.latitude&&""!==i.latitude&&i.longitude&&""!==i.longitude||(i=e.currentLocation);const n=a.currentLocation&&a.currentLocation.displayName;a.currentLocation=Object.assign({},i),a.currentLocation.displayName=n,a.unit=o}))||w.a.handleAction(t,o.a.updateLocationDisplayName,t=>{a=Object.assign({},e),t&&e.currentLocation&&e.currentLocation.latitude===t.latitude&&e.currentLocation.longitude===t.longitude&&t.displayName&&""!==t.displayName.trim()?(a.currentLocation=Object.assign({},a.currentLocation),a.currentLocation.displayName=t.displayName):(a.currentLocation=Object.assign({},a.currentLocation),a.currentLocation.displayName=`${t.locality}, ${t.region}`)}))||w.a.handleAction(t,o.a.updateLocationDetectionState,(t,i)=>{(a=Object.assign({},e)).locationDetectionSetting=t,a.currentLocation=i}),a||e}}i.d(t,"ToolingInfo",function(){return N}),i.d(t,"WeatherDataActions",function(){return o.a}),i.d(t,"WeatherDataConnector",function(){return T}),i.d(t,"WeatherDataReducer",function(){return F}),i.d(t,"WeatherLocation",function(){return a.c}),i.d(t,"WeatherUnit",function(){return a.d}),i.d(t,"LocationDetectionSetting",function(){return a.a}),i.d(t,"WeatherDataConstants",function(){return a.b});const N={experienceConfigSchema:n.WeatherDataConfigSchema}},cYI1:function(e,t){},hSGL:function(e,t,i){"use strict";i.d(t,"a",function(){return g});var a=i("D57K"),o=i("rvYQ"),n=i("zfSW"),r=i("msIb"),c=i("6ADy"),s=i("KETb"),d=i("tERu"),u=i("l+Jz"),l=i("/+Un"),h=i("tMmC");class g{constructor(e){this.fetchImpl=e,this.ocid="Peregrine",this.userUpdateEndpoint="msn/user",this.pdpServiceEndpoint="graph/actions"}updatePdpHomeLocation(e,t){return Object(a.a)(this,void 0,void 0,function*(){const i={method:"POST",body:JSON.stringify({actionType:"Follow",targetType:"Location",definitionName:t,degree:"DefaultLocation",metaData:e}),headers:yield r.a.getOneServiceHeaders(),credentials:"include"},n=Object(c.d)(this.pdpServiceEndpoint);let u;((yield Object(l.b)())===d.c.SignedIn?r.a.getOneServiceParamsWithAuth(Object(o.b)().UserId,this.ocid):r.a.getOneServiceParamsWithoutAuth(Object(o.b)().UserId,this.ocid)).forEach(e=>{e.value&&n.searchParams.set(e.key,e.value)});try{u=yield Object(s.a)(()=>Object(a.a)(this,void 0,void 0,function*(){let e=yield this.fetchImpl(n.href,i);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for actionType: Follow, targetType: Location`;throw new Error(t)}return e.json()}),"setPdpHomeLocation")}catch(e){return!1}return!0})}updatePdpDisplayUnit(e){return Object(a.a)(this,void 0,void 0,function*(){const t='{"weatherDisplayUnit":"'+e+'"}',i={method:"PUT",body:JSON.stringify({dummyid:t}),credentials:"include"},a=Object(c.d)(this.userUpdateEndpoint);((yield Object(l.b)())===d.c.SignedIn?r.a.getOneServiceParamsWithAuth(Object(o.b)().UserId,this.ocid):r.a.getOneServiceParamsWithoutAuth(Object(o.b)().UserId,this.ocid)).forEach(e=>{e.value&&a.searchParams.set(e.key,e.value)});try{let e=yield this.fetchImpl(a.href,i);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for update display Unit setting call`;throw new Error(t)}}catch(e){return!1}return!0})}getPdpLayoutPreference(){return Object(a.a)(this,void 0,void 0,function*(){const e={method:"GET",credentials:"include",headers:yield r.a.getOneServiceHeaders()},t=Object(c.d)(this.userUpdateEndpoint);[...(yield Object(l.b)())===d.c.SignedIn?r.a.getOneServiceParamsWithAuth(Object(o.b)().UserId,this.ocid):r.a.getOneServiceParamsWithoutAuth(Object(o.b)().UserId,this.ocid)].forEach(e=>{e.value&&t.searchParams.set(e.key,e.value)});try{return yield Object(s.a)(()=>Object(a.a)(this,void 0,void 0,function*(){let i=yield this.fetchImpl(t.href,e);if(!i.ok)throw Error(i.statusText);return i.json()}),"readPDPData")}catch(e){return h.a.logError(e.message),null}})}updatePdpLayoutPreference(e){return Object(a.a)(this,void 0,void 0,function*(){const t={method:"PUT",credentials:"include",body:JSON.stringify({dummyid:{userLayoutPreference:e}})},i=Object(c.d)(this.userUpdateEndpoint);((yield Object(l.b)())===d.c.SignedIn?r.a.getOneServiceParamsWithAuth(Object(o.b)().UserId,this.ocid):r.a.getOneServiceParamsWithoutAuth(Object(o.b)().UserId,this.ocid)).forEach(e=>{e.value&&i.searchParams.set(e.key,e.value)});try{let e=yield this.fetchImpl(i.href,t);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for update layout preference setting call`;throw new Error(t)}}catch(e){return h.a.logError(e.message),!1}return!0})}readPdpWithTargetType(e){return Object(a.a)(this,void 0,void 0,function*(){const t={key:"$filter",value:`actionType eq 'Follow' and targetType eq '${e}' `},i=yield r.a.getBaseRequestData("GET");i.credentials="include";const n=Object(c.d)(this.pdpServiceEndpoint);[t,...(yield Object(l.b)())===d.c.SignedIn?r.a.getOneServiceParamsWithAuth(Object(o.b)().UserId,this.ocid):r.a.getOneServiceParamsWithoutAuth(Object(o.b)().UserId,this.ocid)].forEach(e=>{e.value&&n.searchParams.set(e.key,e.value)});let u=null;return(u=yield this.getFromWebWorker(e))||(u=yield Object(s.a)(()=>Object(a.a)(this,void 0,void 0,function*(){let e=yield this.fetchImpl(n.href,i);if(!e.ok)throw Error(e.statusText);return e.json()}),"readPDPData")),u})}getFromWebWorker(e){return Object(a.a)(this,void 0,void 0,function*(){let t=null;if(n.b){const i=this.maptoWebWorkerId(e);if(i&&i.trim()){let i=yield Object(n.a)({id:this.maptoWebWorkerId(e)});i.fetched&&(t=i.payload)}}return t})}maptoWebWorkerId(e){switch(e){case"Location":return u.a.WeatherPdp;case"League":return u.a.SportsLeaguePdp;case"Player":return u.a.SportsPlayerPdp;case"Team":return u.a.SportsTeamPdp;case"Finance":return u.a.MoneyPdp;default:return""}}}}}]);
//# sourceMappingURL=weather-data-connector.f0b1e8504e740b20fe93.js.map